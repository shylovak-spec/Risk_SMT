<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Журнал оцінки ризиків + Гра</title>
<style>
:root {
    --card-bg: #1a1a1a;
    --risk-color: #ff0000;
    --control-color: #00ff00;
    --app-bg: #f4f4f4;
    --ping-pong-bg: #0b1020;
    --ping-pong-accent: #39ff14;
    --ping-pong-panel: rgba(255,255,255,0.04);
}
body { font-family: Arial,sans-serif; margin:0; padding:0; background-color: var(--app-bg); color:#333; perspective:1000px; }
#landing-page { display:flex; flex-direction:column; justify-content:center; align-items:center; height:100vh; text-align:center; background-color:var(--card-bg); color:white; padding:20px; box-sizing:border-box; }
#landing-page h1 { font-size:2.5em; margin-bottom:40px; font-weight:700; }
#start-button { padding:15px 30px; font-size:1.2em; cursor:pointer; background-color:white; color:var(--card-bg); border:none; border-radius:8px; transition:0.3s; box-shadow:0 4px 6px rgba(0,0,0,0.3); }
#card-page { display:none; padding:20px; background-color:var(--app-bg); min-height:100vh; }
.cards-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(280px,1fr)); gap:30px; justify-content:center; max-width:1200px; margin:0 auto; }
.card-container { width:100%; height:200px; perspective:1000px; cursor:pointer; }
.card { width:100%; height:100%; position:relative; transform-style:preserve-3d; transition:transform 0.8s; box-shadow:0 10px 20px rgba(0,0,0,0.5); border-radius:12px; }
.card.is-flipped { transform: rotateY(180deg); }
.card-face { position:absolute; width:100%; height:100%; backface-visibility:hidden; background-color:var(--card-bg); color:white; padding:20px; box-sizing:border-box; display:flex; flex-direction:column; justify-content:space-around; align-items:center; border-radius:12px; border:4px solid; transition:border-color 0.8s; }
.card-face-front { border-color: var(--risk-color); }
.card-face-back { transform: rotateY(180deg); border-color: var(--control-color); }

#next-button { display:none; margin:20px auto; padding:12px 24px; font-size:1.2em; border:none; border-radius:8px; background-color:var(--ping-pong-accent); color:#000; cursor:pointer; box-shadow:0 4px 6px rgba(0,0,0,0.3); }

#game-section { display:none; min-height:100vh; background:linear-gradient(180deg,#061021,#081426); color:#ddd; padding:20px; box-sizing:border-box; align-items:center; justify-content:center; flex-direction:column; }
.game-wrap { width:820px; max-width:100%; padding:20px; border-radius:12px; background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent); box-shadow:0 8px 30px rgba(2,6,23,0.6); }
.game-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:12px; flex-wrap:wrap; }
.game-header h2 { font-size:1.5em; margin:0; color:white; }
.game-info { font-size:13px; color:#bcd; }
.game-board { display:flex; gap:12px; flex-wrap:wrap; }
canvas { background:linear-gradient(180deg,#00111b 0%,#011827 100%); border-radius:6px; display:block; width:100%; max-width:560px; height:auto !important; aspect-ratio:560/360; }
.game-sidebar { width:220px; min-width:160px; padding:12px; border-radius:8px; background:var(--ping-pong-panel); height:360px; }
.game-stat strong { display:block; font-size:20px; color:var(--ping-pong-accent); }
.game-controls { display:flex; flex-direction:column; gap:8px; }
.game-controls button { background:transparent; border:1px solid rgba(255,255,255,0.08); padding:8px; border-radius:6px; color:#e8f; cursor:pointer; transition: transform 0.1s; }
.game-controls button:hover { transform:translateY(-1px); }
.game-small { font-size:12px; color:#aac; }

@media(max-width:768px){
    #landing-page h1{font-size:2em;}
    .cards-grid{grid-template-columns:1fr;}
    .card-container{height:250px;}
    .game-board{flex-direction:column;}
    .game-sidebar{width:100%; height:auto; order:1;}
    canvas{order:2;}
    .game-wrap{padding:10px;}
    .game-header{flex-direction:column; align-items:flex-start;}
    .game-info{margin-top:5px;}
}
</style>
</head>
<body>

<div id="landing-page">
    <h1>Журнал оцінки ризиків для дільниці SMT</h1>
    <button id="start-button">СТАРТ</button>
</div>

<div id="card-page">
    <div class="cards-grid">
        <div class="card-container" data-card-id="1"><div class="card" onclick="flipCard(this.parentNode)"><div class="card-face card-face-front"><h3>Ризик №1</h3></div><div class="card-face card-face-back"><h3>Контроль №1</h3></div></div></div>
        <div class="card-container" data-card-id="2"><div class="card" onclick="flipCard(this.parentNode)"><div class="card-face card-face-front"><h3>Ризик №2</h3></div><div class="card-face card-face-back"><h3>Контроль №2</h3></div></div></div>
        <div class="card-container" data-card-id="3"><div class="card" onclick="flipCard(this.parentNode)"><div class="card-face card-face-front"><h3>Ризик №3</h3></div><div class="card-face card-face-back"><h3>Контроль №3</h3></div></div></div>
        <div class="card-container" data-card-id="4"><div class="card" onclick="flipCard(this.parentNode)"><div class="card-face card-face-front"><h3>Ризик №4</h3></div><div class="card-face card-face-back"><h3>Контроль №4</h3></div></div></div>
        <div class="card-container" data-card-id="5"><div class="card" onclick="flipCard(this.parentNode)"><div class="card-face card-face-front"><h3>Ризик №5</h3></div><div class="card-face card-face-back"><h3>Контроль №5</h3></div></div></div>
    </div>
    <button id="next-button">Пограєм?</button>
</div>

<div id="game-section">
    <div class="game-wrap">
        <header class="game-header">
            <h2>Вітаємо! Тепер грайте!</h2>
            <div class="game-info">Керування: ← → або рух/торкання</div>
        </header>
        <div class="game-board">
            <canvas id="game" width="560" height="360"></canvas>
            <aside class="game-sidebar">
                <div class="game-stat">Очки: <strong id="score">0</strong></div>
                <div class="game-stat">Найкращий: <strong id="best">0</strong></div>
                <div class="game-stat game-small">Режим: <span id="mode">Готово</span></div>
                <div class="game-controls">
                    <button id="start">Старт / Перезапустити</button>
                    <button id="pause">Пауза</button>
                    <label class="game-small">Швидкість <input id="speed" type="range" min="2" max="8" value="4"></label>
                    <label class="game-small">Ширина ракетки <input id="paddleWidth" type="range" min="60" max="180" value="100"></label>
                </div>
            </aside>
        </div>
    </div>
</div>

<script>
// === Картки ===
const totalCards=5;
const flippedCards=new Set();
const nextBtn=document.getElementById('next-button');
document.getElementById('start-button').addEventListener('click',()=>{document.getElementById('landing-page').style.display='none';document.getElementById('card-page').style.display='block';});
function flipCard(container){
    const cardElement=container.querySelector('.card');
    const cardId=container.dataset.cardId;
    cardElement.classList.toggle('is-flipped');
    if(!flippedCards.has(cardId)) flippedCards.add(cardId);
    if(flippedCards.size===totalCards) nextBtn.style.display='block';
}
nextBtn.addEventListener('click',()=>{document.getElementById('card-page').style.display='none';document.getElementById('game-section').style.display='flex';initializeGame();});

// === Гра Ping-Pong ===
const canvas=document.getElementById('game');
const ctx=canvas.getContext('2d');
const scoreEl=document.getElementById('score');
const bestEl=document.getElementById('best');
const startBtn=document.getElementById('start');
const pauseBtn=document.getElementById('pause');
const speedInput=document.getElementById('speed');
const paddleWidthInput=document.getElementById('paddleWidth');
const modeEl=document.getElementById('mode');
const W=560,H=360;
let state,paddle,ball,gameInterval;

function initializeGame(){
    state={running:false,paused:false,score:0,best:Number(localStorage.getItem('pp_best')||0),ballSpeedBase:+speedInput.value,paddleWidth:+paddleWidthInput.value,awaitingStart:true};
    bestEl.textContent=state.best;
    paddle={w:state.paddleWidth,h:12,x:(W-state.paddleWidth)/2,y:H-24,vx:0};
    ball={r:8,x:paddle.x+paddle.w/2,y:paddle.y-8,vx:0,vy:0};
    if(!gameInterval){gameInterval=setInterval(step,1000/60);updatePaddleFromKeys();renderLoop();}
    modeEl.textContent="Торкніться м'яч, щоб стартувати";
}

function resetGame(){state.score=0;scoreEl.textContent=0;paddle.w=state.paddleWidth;paddle.x=(W-paddle.w)/2;ball.x=paddle.x+paddle.w/2;ball.y=paddle.y-ball.r;ball.vx=0;ball.vy=0;state.running=true;state.paused=false;state.awaitingStart=true;modeEl.textContent="Торкніться м'яч, щоб стартувати";}
function step(){if(!state||!state.running||state.paused) return;if(state.awaitingStart){ball.x=paddle.x+paddle.w/2;ball.y=paddle.y-ball.r;return;}ball.x+=ball.vx;ball.y+=ball.vy;if(ball.x-ball.r<=0){ball.x=ball.r;ball.vx*=-1;}if(ball.x+ball.r>=W){ball.x=W-ball.r;ball.vx*=-1;}if(ball.y-ball.r<=0){ball.y=ball.r;ball.vy*=-1;}if(ball.y+ball.r>=paddle.y&&ball.y+ball.r<=paddle.y+paddle.h&&ball.x>=paddle.x&&ball.x<=paddle.x+paddle.w){const relative=(ball.x-(paddle.x+paddle.w/2))/(paddle.w/2);const speed=Math.hypot(ball.vx,ball.vy);const maxBounce=Math.PI/3;const angle=relative*maxBounce+Math.PI/2;ball.vx=speed*Math.cos(angle);ball.vy=-Math.abs(speed*Math.sin(angle));state.score+=1;scoreEl.textContent=state.score;if(state.score>state.best){state.best=state.score;bestEl.textContent=state.best;localStorage.setItem('pp_best',state.best);}const spd=1+state.score*0.02;ball.vx*=spd;ball.vy*=spd;}if(ball.y-ball.r>H){state.running=false;modeEl.textContent='Game Over';}paddle.x+=paddle.vx;if(paddle.x<0)paddle.x=0;if(paddle.x+paddle.w>W)paddle.x=W-paddle.w;}
function draw(){ctx.clearRect(0,0,W,H);ctx.fillStyle='rgba(255,255,255,0.03)';for(let i=0;i<H;i+=20) ctx.fillRect(W/2-1,i+6,2,12);ctx.fillStyle='var(--ping-pong-accent)';ctx.beginPath();ctx.arc(ball.x,ball.y,ball.r,0,Math.PI*2);ctx.fill();ctx.fillStyle='rgba(255,255,255,0.14)';ctx.fillRect(paddle.x,paddle.y,paddle.w,paddle.h);ctx.fillStyle='rgba(255,255,255,0.06)';ctx.fillRect(8,8,120,30);ctx.fillStyle='#bce';ctx.font='14px Arial';ctx.fillText('Score: '+state.score,14,28);}
function renderLoop(){draw();requestAnimationFrame(renderLoop);}
let left=false,right=false;
window.addEventListener('keydown',e=>{if(e.key==='ArrowLeft') left=true;if(e.key==='ArrowRight') right=true;if(e.key===' '&&state.running){state.paused=!state.paused;modeEl.textContent=state.paused?'Пауза':'Гра';}});
window.addEventListener('keyup',e=>{if(e.key==='ArrowLeft') left=false;if(e.key==='ArrowRight') right=false;});
function updatePaddleFromKeys(){const speed=6;paddle.vx=0;if(left)paddle.vx=-speed;else if(right)paddle.vx=speed;requestAnimationFrame(updatePaddleFromKeys);}
canvas.addEventListener('mousemove',handleInput);
canvas.addEventListener('touchmove',e=>{e.preventDefault();handleInput(e.touches[0]);});
function handleInput(e){if(!state.running||state.paused) return;const rect=canvas.getBoundingClientRect();const scaleX=W/rect.width;const mx=(e.clientX||e.pageX)-rect.left;paddle.x=(mx*scaleX)-paddle.w/2;if(paddle.x<0)paddle.x=0;if(paddle.x+paddle.w>W)paddle.x=W-paddle.w;}
function startBall(){if(state.awaitingStart){const speed=state.ballSpeedBase;const angle=(Math.random()*Math.PI/2-Math.PI/4);ball.vx=speed*Math.cos(angle)*(Math.random()<0.5?-1:1);ball.vy=-Math.abs(speed*Math.sin(angle)||-speed*0.6);state.awaitingStart=false;modeEl.textContent='Гра';}}
canvas.addEventListener('mousedown',startBall);
canvas.addEventListener('touchstart',e=>{e.preventDefault();startBall();});
startBtn.addEventListener('click',()=>{state.ballSpeedBase=+speedInput.value;state.paddleWidth=+paddleWidthInput.value;resetGame();});
pauseBtn.addEventListener('click',()=>{if(state.running){state.paused=!state.paused;modeEl.textContent=state.paused?'Пауза':'Гра';}});
speedInput.addEventListener('input',()=>{state.ballSpeedBase=+speedInput.value;});
paddleWidthInput.addEventListener('input',()=>{state.paddleWidth=+paddleWidthInput.value;paddle.w=state.paddleWidth;paddle.x=Math.min(paddle.x,W-paddle.w);});
</script>
</body>
</html>
